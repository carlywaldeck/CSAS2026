# CSAS 2026 Curling Data Challenge Submission

## Strategic Analysis of Power Play Deployment in Mixed Doubles Curling

**Team:** USA Curling Performance Team  
**Challenge:** CSAS 2026 Data Challenge  
**Date:** January 2026

---

## Overview

This submission analyzes Power Play deployment strategy in international Mixed Doubles Curling competition. The analysis addresses Coach Phil Lazar's question: "We never know if using the Power Play in the first end or first half is right or wrong."

**Key Research Question:** When should teams deploy the Power Play - early (First Strike) or late (Insurance Closer)?

---

## Submission Contents

### 1. Analysis Code
**`challenge_analysis.py`**  
Main Python script that performs all calculations and generates outputs referenced in the report.

### 2. Final Report
**`CSAS2026_FULL_REPORT.md`**  
Complete academic report with Abstract, Introduction, Methods, Results, Discussion, Recommendations, and Conclusion.

**`FINAL_REPORT_CSAS2026.md`**  
Alternative report format with strategic framework and recommendations.

### 3. Visualization
**`power_play_by_end.png`**  
Bar chart showing Power Play effectiveness by end number (automatically generated by the script).

---

## Requirements

### Python Version
- Python 3.7 or higher

### Required Libraries
Install dependencies using pip:
```bash
pip install pandas numpy matplotlib
```

Or create a requirements.txt and install:
```bash
pip install -r requirements.txt
```

**Required packages:**
- pandas (for data manipulation)
- numpy (for numerical calculations)
- matplotlib (for visualization)

---

## How to Run the Code

### Step 1: Prepare Data Files

Place the following CSV files in the same directory as `challenge_analysis.py`:
- `Stones.csv` - Stone-level data (shot positions, execution scores)
- `Ends.csv` - End-level data (Power Play indicators, results)
- `Teams.csv` - Team information (optional, for team comparison analysis)
- `Games.csv` - Game information (optional)
- `Competition.csv` - Competition information (optional)
- `Competitors.csv` - Competitor information (optional)

**Note:** The script requires at minimum `Stones.csv` and `Ends.csv`. Other files are optional and used for additional analyses.

### Step 2: Update Data Directory Path

Open `challenge_analysis.py` and update the `DATA_DIR` constant on line 26:

```python
# Change this to your data directory path
DATA_DIR = "/path/to/your/data/directory"
```

Or place the CSV files in the same directory as the script and set:
```python
DATA_DIR = "."  # Current directory
```

### Step 3: Run the Script

Execute the analysis script:
```bash
python3 challenge_analysis.py
```

Or on Windows:
```bash
python challenge_analysis.py
```

### Step 4: View Results

The script will:
1. Print all analysis results to the console
2. Generate `power_play_by_end.png` visualization in the data directory
3. Display key metrics and statistics

**Expected Output:**
- Traffic calculation statistics
- Power Play deployment distribution
- Shot accuracy analysis (Draws vs Wicks)
- Traffic impact on Power Play scoring
- Team comparison (GBR vs Italy)
- Visualization saved to disk

---

## Code Structure

### Main Functions

1. **`load_data()`** - Loads CSV files into pandas DataFrames
2. **`calculate_traffic(stones)`** - Calculates Traffic metric (stones in house)
3. **`calculate_pprs(stones, ends)`** - Calculates Power Play Readiness Score
4. **`analyze_deployment(ends)`** - Analyzes Power Play deployment patterns
5. **`analyze_shot_types(stones)`** - Compares Draw vs Wick execution scores
6. **`analyze_traffic_effect(stones_with_traffic, ends)`** - Analyzes Traffic Tax
7. **`compare_teams(ends, stones)`** - Compares team performance (GBR vs Italy)
8. **`make_plot(ends)`** - Generates visualization
9. **`main()`** - Orchestrates all analyses

### Key Metrics Calculated

- **Traffic:** Number of stones within 600 units of button (x=750, y=800)
- **Traffic Tax:** Efficiency penalty when Traffic exceeds 5 stones (-12.3%)
- **Execution Gap:** Difference between Draw (3.13/4.0) and Wick (2.75/4.0) execution
- **Power Play Efficiency:** Average points scored by end number
- **Deployment Distribution:** Frequency of Power Play usage by end

---

## Reproducibility

### To Reproduce All Results:

1. **Ensure data files are in place:**
   - `Stones.csv` and `Ends.csv` are required
   - Other CSV files are optional

2. **Update the DATA_DIR path** in `challenge_analysis.py` (line 26)

3. **Install dependencies:**
   ```bash
   pip install pandas numpy matplotlib
   ```

4. **Run the script:**
   ```bash
   python3 challenge_analysis.py
   ```

5. **Verify outputs:**
   - Check console for all statistics
   - Verify `power_play_by_end.png` is generated
   - Compare results with report values

### Expected Results

The script should produce:
- Average Traffic: ~1.5-2.0 stones in house
- Total Power Plays: 598 ends
- Draw accuracy: 3.13/4.0 (78.3%)
- Wick accuracy: 2.75/4.0 (68.8%)
- Execution Gap: 13.6%
- Traffic Tax: -12.3% (high vs low Traffic)

---

## Key Findings Summary

1. **Conservation Deadlock:** Only 1 End 1-2 Power Play in 5,274 ends (0.02%)
2. **Traffic Tax:** High Traffic (5+ stones) reduces Power Play efficiency by 12.3%
3. **Execution Gap:** Draws (3.13/4.0) outperform Wicks (2.75/4.0) by 13.6%
4. **End 8 Efficiency:** Power Plays in End 8 average 2.51 points (highest)
5. **Team Differences:** GBR shows higher execution consistency than Italy

---

## Methodology

### Coordinate System
- Button position: (x=750, y=800)
- House radius: 600 units
- Center corridor: |x - 750| < 200

### Data Processing
- Stones with sentinel value 4095 are excluded (removed from play)
- Stones with value 0 are excluded (not yet thrown)
- Traffic is calculated at each shot during Power Play execution
- All calculations use Euclidean distance formula

### Statistical Analysis
- Descriptive statistics (mean, std dev, counts)
- Grouped aggregations by end number, Traffic level, shot type
- Comparative analysis between teams and shot types

---

## File Structure

```
submission_files/
├── README.md                    # This file
├── challenge_analysis.py        # Main analysis script
├── CSAS2026_FULL_REPORT.md     # Complete academic report
├── FINAL_REPORT_CSAS2026.md    # Alternative report format
└── power_play_by_end.png       # Generated visualization

data/                            # CSV files (not included in submission)
├── Stones.csv
├── Ends.csv
├── Teams.csv
├── Games.csv
├── Competition.csv
└── Competitors.csv
```

---

## Troubleshooting

### Common Issues

**Issue:** `FileNotFoundError` when loading CSV files
- **Solution:** Update `DATA_DIR` path in `challenge_analysis.py` to point to your data directory

**Issue:** `ModuleNotFoundError` for pandas/numpy/matplotlib
- **Solution:** Install missing packages: `pip install pandas numpy matplotlib`

**Issue:** Script runs but produces different results
- **Solution:** Ensure you're using the same CSV data files from the challenge

**Issue:** Visualization not generated
- **Solution:** Check that matplotlib is installed and the data directory is writable

---

## Data Source

Analysis based on data from Curlit:
- Beijing 2022 Olympic Winter Games
- World Mixed Doubles Curling Championships 2023-2025

**Note:** CSV data files are provided separately by the challenge organizers and should be placed in the data directory before running the script.

---

## Contact & Questions

For questions about:
- **Methodology:** See Methods section in `CSAS2026_FULL_REPORT.md`
- **Results:** See Results section in `CSAS2026_FULL_REPORT.md`
- **Code Logic:** See function docstrings and comments in `challenge_analysis.py`

---

## Version Information

**Version:** Final Submission  
**Date:** January 2026  
**Python Version:** 3.7+  
**Author:** Cal Poly Student (CS 202)

---

## License

This code is submitted for the CSAS 2026 Data Challenge. All analysis and findings are original work based on the provided dataset.
