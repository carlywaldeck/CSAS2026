# CSAS 2026 Curling Data Challenge Submission

## Strategic Analysis of Power Play Deployment in Mixed Doubles Curling

**Team:** USA Curling Performance Team  
**Challenge:** CSAS 2026 Data Challenge  
**Date:** January 2026

---

## Overview

This submission analyzes Power Play deployment strategy in international Mixed Doubles Curling competition. The analysis addresses Coach Phil Lazar's question: "We never know if using the Power Play in the first end or first half is right or wrong."

**Key Research Question:** When should teams deploy the Power Play - early (First Strike) or late (Insurance Closer)?

**Dataset:** $26,370$ stone records across $5,274$ ends from Beijing 2022 Olympics and World Mixed Doubles Curling Championships (2023-2025).

---

## Submission Contents

### 1. Analysis Code
**`challenge_analysis.py`**  
Main Python script that performs all calculations and generates outputs referenced in the report. The code is written at an intermediate student level (CS 202/203 style) with clear comments and straightforward logic.

### 2. Final Report
**`CSAS2026_FULL_REPORT.md`**  
Complete academic report with Abstract, Introduction, Methods, Results, Discussion, Recommendations, and Conclusion. This is the primary submission document.

### 3. Visualizations
**`power_play_distribution.png`**  
Bar chart showing Power Play deployment distribution by end number (1-8).

**`power_play_avg_points.png`**  
Bar chart showing average points scored per Power Play by end number.

Both visualizations are automatically generated by `challenge_analysis.py`.

### 4. Dependencies
**`requirements.txt`**  
Python package dependencies for reproducibility.

---

## Requirements

### Python Version
- Python 3.7 or higher

### Required Libraries
Install dependencies using pip:
```bash
pip install -r requirements.txt
```

**Required packages:**
- pandas (for data manipulation)
- numpy (for numerical calculations)
- matplotlib (for visualization)

---

## How to Run the Code

### Step 1: Prepare Data Files

Place the following CSV files in the **parent directory** of `submission_files/`:
- `Stones.csv` - Stone-level data (shot positions, execution scores)
- `Ends.csv` - End-level data (Power Play indicators, results)
- `Teams.csv` - Team information (optional, for team comparison analysis)
- `Games.csv` - Game information (optional)
- `Competition.csv` - Competition information (optional)
- `Competitors.csv` - Competitor information (optional)

**Directory Structure:**
```
CSAS2026/
├── Stones.csv
├── Ends.csv
├── Teams.csv
├── Games.csv
├── Competition.csv
├── Competitors.csv
└── submission_files/
    ├── challenge_analysis.py
    ├── README.md
    ├── CSAS2026_FULL_REPORT.md
    ├── requirements.txt
    ├── power_play_distribution.png
    └── power_play_avg_points.png
```

**Note:** The script requires at minimum `Stones.csv` and `Ends.csv`. Other files are optional and used for additional analyses (e.g., team comparisons).

### Step 2: Navigate to Submission Directory

```bash
cd submission_files
```

### Step 3: Run the Script

Execute the analysis script:
```bash
python3 challenge_analysis.py
```

Or on Windows:
```bash
python challenge_analysis.py
```

### Step 4: View Results

The script will:
1. Print all analysis results to the console
2. Generate `power_play_distribution.png` in the `submission_files/` directory
3. Generate `power_play_avg_points.png` in the `submission_files/` directory
4. Display key metrics and statistics

**Expected Output:**
- Traffic calculation statistics
- Power Play deployment distribution by end
- Shot accuracy analysis (Draws vs Wicks)
- Traffic impact on Power Play scoring (Traffic Tax)
- Team comparison (GBR vs Italy)
- Visualizations saved to disk

---

## Code Structure

### Main Functions

1. **`load_data()`** - Loads CSV files into pandas DataFrames
2. **`calculate_traffic(stones)`** - Calculates Traffic metric (stones in house)
3. **`calculate_pprs(stones, ends)`** - Calculates Power Play Readiness Score
4. **`analyze_deployment(ends)`** - Analyzes Power Play deployment patterns
5. **`analyze_shot_types(stones)`** - Compares Draw vs Wick execution scores
6. **`analyze_traffic_effect(stones_with_traffic, ends)`** - Analyzes Traffic Tax
7. **`compare_teams(ends, stones)`** - Compares team performance (GBR vs Italy)
8. **`make_plots(ends)`** - Generates both visualizations
9. **`main()`** - Orchestrates all analyses

### Key Metrics Calculated

- **Traffic:** Number of stones within 600 units of button (x=750, y=800)
- **Traffic Tax:** Efficiency penalty when Traffic exceeds 5 stones (-12.3%)
- **Execution Gap:** Difference between Draw (3.13/4.0) and Wick (2.75/4.0) execution (13.6%)
- **Power Play Efficiency:** Average points scored by end number
- **Deployment Distribution:** Frequency of Power Play usage by end (1-8)
- **Handle-Side Matching:** Analysis of stone rotation (Handle) vs Power Play side selection

---

## Reproducibility

### To Reproduce All Results:

1. **Ensure data files are in place:**
   - `Stones.csv` and `Ends.csv` are required (in parent directory)
   - Other CSV files are optional

2. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

3. **Run the script:**
   ```bash
   cd submission_files
   python3 challenge_analysis.py
   ```

4. **Verify outputs:**
   - Check console for all statistics
   - Verify `power_play_distribution.png` is generated
   - Verify `power_play_avg_points.png` is generated
   - Compare results with report values

### Expected Results

The script should produce:
- Average Traffic: ~1.5-2.0 stones in house
- Total Power Plays: 598 ends
- End 1-2 Power Plays: 1 instance (0.02%)
- End 6-7 Power Plays: 413 instances (69.1%)
- End 8 Power Plays: 65 instances (10.9%)
- Draw accuracy: 3.13/4.0 (78.3%)
- Wick accuracy: 2.75/4.0 (68.8%)
- Execution Gap: 13.6%
- Traffic Tax: -12.3% (high vs low Traffic)
- End 8 Right Side + Handle 0: 3.73 points (optimal combination)

---

## Key Findings Summary

1. **Conservation Deadlock:** Only 1 End 1-2 Power Play in 5,274 ends (0.02%) - near-unanimous consensus on late deployment
2. **Execution Gap:** Draws (3.13/4.0) outperform Wicks (2.75/4.0) by 13.6% - fresh ice advantage for early deployment
3. **Traffic Tax:** High Traffic (5+ stones) reduces Power Play efficiency by 12.3% regardless of timing
4. **End 8 Efficiency:** Power Plays in End 8 average 2.51 points (highest), but may be partially inflated by opponent desperation
5. **Handle-Side Matching:** In End 8, Right Side Power Plays with In-turn (Handle 0) average 3.73 points vs 1.75 points for mismatched combinations - a 113.3% improvement
6. **Team Differences:** GBR shows higher execution consistency (std dev 0.85) than Italy (std dev 2.24)

---

## Methodology

### Coordinate System
- Button position: (x=750, y=800)
- House radius: 600 units
- Center corridor: |x - 750| < 200

### Data Processing
- Stones with sentinel value 4095 are excluded (removed from play)
- Stones with value 0 are excluded (not yet thrown)
- Traffic is calculated at each shot during Power Play execution
- All calculations use Euclidean distance formula: √[(x - 750)² + (y - 800)²]

### Statistical Analysis
- Descriptive statistics (mean, std dev, counts)
- Grouped aggregations by end number, Traffic level, shot type
- Comparative analysis between teams and shot types
- Handle-Side correlation analysis for Power Play effectiveness

---

## File Structure

```
submission_files/
├── README.md                    # This file
├── challenge_analysis.py        # Main analysis script
├── CSAS2026_FULL_REPORT.md     # Complete academic report
├── requirements.txt            # Python dependencies
├── power_play_distribution.png # Deployment distribution graph
└── power_play_avg_points.png   # Average points by end graph

../                              # Parent directory (data files)
├── Stones.csv
├── Ends.csv
├── Teams.csv
├── Games.csv
├── Competition.csv
└── Competitors.csv
```

---

## Troubleshooting

### Common Issues

**Issue:** `FileNotFoundError` when loading CSV files
- **Solution:** Ensure CSV files are in the parent directory (one level up from `submission_files/`). The script uses `DATA_DIR = "../"` to look for files in the parent directory.

**Issue:** `ModuleNotFoundError` for pandas/numpy/matplotlib
- **Solution:** Install missing packages: `pip install pandas numpy matplotlib`

**Issue:** Script runs but produces different results
- **Solution:** Ensure you're using the same CSV data files from the challenge

**Issue:** Visualizations not generated
- **Solution:** Check that matplotlib is installed and the `submission_files/` directory is writable

**Issue:** Team comparison returns "No data"
- **Solution:** Ensure `Teams.csv` is in the parent directory and contains NOC codes for GBR and ITA

---

## Data Source

Analysis based on data from Curlit:
- Beijing 2022 Olympic Winter Games
- World Mixed Doubles Curling Championships 2023-2025

**Note:** CSV data files are provided separately by the challenge organizers and should be placed in the parent directory before running the script.

---

## Report Sections

The full report (`CSAS2026_FULL_REPORT.md`) contains:

1. **Abstract** - Summary of findings and conclusions
2. **Introduction** - Coach Lazar's question, baseball analogy, Conservation Deadlock
3. **Methods** - Data sources, metrics (Traffic, Execution), statistical approach
4. **Results** - Deployment patterns, efficiency by end, Traffic Tax, execution analysis, team comparisons, Handle-Side correlation
5. **Discussion** - Strategic implications, early vs late deployment, Traffic management
6. **Strategic Recommendations** - Context-dependent framework, Team USA analysis
7. **Handle Rotation Analysis** - End 8 Handle-Side mismatch penalty finding

---

## Contact & Questions

For questions about:
- **Methodology:** See Methods section in `CSAS2026_FULL_REPORT.md`
- **Results:** See Results section in `CSAS2026_FULL_REPORT.md`
- **Code Logic:** See function docstrings and comments in `challenge_analysis.py`

---

## Version Information

**Version:** Final Submission  
**Date:** January 2026  
**Python Version:** 3.7+  
**Author:** Cal Poly Student (CS 202/203)

---

## License

This code is submitted for the CSAS 2026 Data Challenge. All analysis and findings are original work based on the provided dataset.
